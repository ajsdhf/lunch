<style>
	.pokerContent{width: 100%;}
	.item{display: inline-block;height: 250px;width: 180px;float: left;margin: 10px;}
	.poker{display: inline-block;height: 250px;width: 180px;background: -webkit-linear-gradient( top,#eee,#aaa);border-radius: 6px;box-shadow: 2px 10px 10px #ccc;cursor: pointer;line-height: 250px;text-align: center;position: absolute;}
	.pokerHidden{display: none;height: 250px;width: 180px;border-radius: 6px;box-shadow: 2px 10px 10px #ccc;cursor: pointer;line-height: 250px;text-align: center;position: absolute;-webkit-transform: rotatey(180deg)}
</style>
<%- partial('module/header',{currMenu:4}) %>
<div class="container">	
	<button class="startBtn btn btn-primary" id="startBtn" >发牌</button>
	<div class="pokerContent">
		
	</div>
</div>
<script>
	var sectionCount = sections.length;
	
	for(var i=0;i<sectionCount;i++){
		$('<div class="item"></div>').appendTo($('.pokerContent'));
	}
	var items = $('.item');
	function startPoker(){
		$('.poker,.pokerHidden').remove();
		sections.sort(function(){ return 0.5 - Math.random() });
		
		$.each(sections,function(i,item){
			var dom = $('<div class="poker" onclick="rotate(this);" title="翻牌" val="'+item+'"></div>').appendTo('.container');			var hiddenDom = $('<div class="pokerHidden"  hideVal="'+item+'">'+item+'</div>').appendTo('.container');
			
			var content =$(items.get(i));
			var top = 	content.offset().top;
			var left = content.offset().left;
			hiddenDom.css({left:left,top:top});
			setTimeout(function(){
				dom.animate({left:left,top:top},200,'',function(){
					
				});
			}, i*100)
			
		});

	}
	$('#startBtn').on('click',function(){
		startPoker();	
	});	
	function rotate(sender){
		deg = 0;
		$('.poker').hide();
		$(sender).show();
		
		startRotate(sender,deg);
	}
	function startRotate(sender,deg){
		var val = $(sender).attr('val');
		if(deg>=90){
			$(sender).hide();
			var hideSender = $('[hideVal="'+val+'"]');
			hideSender.show();
			deg+=9;
			var newDeg = deg +  180;
			hideSender.css({'-webkit-transform':'rotateY('+newDeg+'deg)'});
			if(deg==180){
				return;
			}
		}
		else{
			deg+=9;
			$(sender).css({'-webkit-transform':'rotateY('+deg+'deg)'});
		}
		setTimeout(function(){
			startRotate(sender,deg);
		}, 30);
	}
	function randomNum(min,max){
	    return Math.floor(min+Math.random()*(max-min));	
	}
</script>